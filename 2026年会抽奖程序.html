<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026æ·±åœ³å¸‚åŸç»¼å°Šé©°å¹´ä¼šå¤§æŠ½å¥–</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #dc2626 50%, #f59e0b 100%);
            min-height: 100vh;
            background-attachment: fixed;
            -webkit-font-smoothing: antialiased;
        }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .number-ball {
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .number-ball:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .number-ball.drawn {
            background: linear-gradient(135deg, #cbd5e0 0%, #a0aec0 100%);
            color: #718096;
            transform: scale(0.9);
            opacity: 0.6;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
        }
        
        .number-ball.winner {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #92400e;
            animation: winnerPulse 1s ease-in-out infinite;
            border: 3px solid #fbbf24;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.6);
        }
        
        @keyframes winnerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .rolling-animation {
            animation: roll 0.1s linear infinite;
        }
        
        @keyframes roll {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f0f;
            position: absolute;
            animation: confetti-fall 3s linear forwards;
            pointer-events: none;
        }
        
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        .btn-shine {
            position: relative;
            overflow: hidden;
        }
        
        .btn-shine::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(to right, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(30deg);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) rotate(30deg); }
            100% { transform: translateX(100%) rotate(30deg); }
        }
        
        .title-glow {
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5), 0 0 40px rgba(255, 215, 0, 0.3);
        }
        
        /* å¾®ä¿¡æµè§ˆå™¨ç‰¹æ®Šæ ·å¼ */
        .wechat-tip {
            display: none;
            background: linear-gradient(135deg, #07c160 0%, #05a050 100%);
        }
        
        .url-display {
            word-break: break-all;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    
    <!-- å¾®ä¿¡æç¤ºå±‚ -->
    <div id="wechatMask" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-full text-center">
            <div class="text-5xl mb-4">ğŸ“²</div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">è¯·åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€</h3>
            <p class="text-gray-600 mb-4 text-sm">å¾®ä¿¡å†…ç½®æµè§ˆå™¨é™åˆ¶ï¼Œè¯·ç‚¹å‡»å³ä¸Šè§’<br>ã€ŒÂ·Â·Â·ã€â†’ã€Œåœ¨Safari/æµè§ˆå™¨ä¸­æ‰“å¼€ã€</p>
            <div class="bg-gray-100 p-3 rounded-lg mb-4">
                <p class="text-xs text-gray-500 mb-1">æˆ–å¤åˆ¶é“¾æ¥åˆ°æµè§ˆå™¨ï¼š</p>
                <p id="wechatUrl" class="url-display text-gray-800 select-all"></p>
            </div>
            <button onclick="copyUrl()" class="w-full py-3 bg-green-500 text-white rounded-xl font-bold mb-2">å¤åˆ¶é“¾æ¥</button>
            <button onclick="closeWechatTip()" class="w-full py-3 bg-gray-200 text-gray-700 rounded-xl font-bold">æˆ‘çŸ¥é“äº†</button>
        </div>
    </div>

    <div class="max-w-6xl mx-auto space-y-6">
        
        <!-- æ ‡é¢˜ -->
        <div class="glass-panel rounded-3xl p-6 md:p-8 text-center shadow-2xl border-4 border-yellow-400">
            <h1 class="text-2xl md:text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-red-600 via-yellow-500 to-red-600 title-glow mb-2">
                ğŸ® 2026æ·±åœ³å¸‚åŸç»¼å°Šé©°å¹´ä¼šå¤§æŠ½å¥– ğŸ®
            </h1>
            <p class="text-gray-600 text-base md:text-lg font-bold">æ‰«ç å‚ä¸ 1-18 æ•°å­—æŠ½å¥–</p>
        </div>

        <!-- å§“åè¾“å…¥åŒºåŸŸ -->
        <div class="glass-panel rounded-3xl p-4 md:p-6 shadow-2xl">
            <div class="flex flex-col md:flex-row gap-4 items-center justify-center">
                <div class="flex-1 w-full md:w-auto">
                    <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ‘¤ æŠ½å¥–äººå§“å</label>
                    <input type="text" id="userName" placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å" maxlength="10"
                        class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-red-500 focus:outline-none transition text-lg"
                        onkeypress="if(event.key==='Enter')setUserName()">
                </div>
                <button onclick="setUserName()" id="nameBtn"
                    class="w-full md:w-auto px-8 py-3 bg-gradient-to-r from-red-500 to-yellow-500 text-white font-bold rounded-xl shadow-lg hover:scale-105 transition whitespace-nowrap">
                    ç¡®è®¤å‚ä¸
                </button>
            </div>
            <p id="currentUser" class="mt-3 text-center text-gray-600 hidden">
                å½“å‰æŠ½å¥–äººï¼š<span class="font-bold text-red-600 text-xl" id="displayUserName"></span>
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            
            <!-- å·¦ä¾§ï¼šäºŒç»´ç å’Œæ§åˆ¶é¢æ¿ -->
            <div class="space-y-6">
                <!-- äºŒç»´ç åŒºåŸŸ -->
                <div class="glass-panel rounded-3xl p-4 md:p-8 shadow-2xl text-center">
                    <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-4 flex items-center justify-center gap-2">
                        <span>ğŸ“±</span> æ‰«ç æŠ½å¥–
                    </h2>
                    
                    <!-- å¾®ä¿¡æç¤º -->
                    <div id="wechatTip" class="wechat-tip text-white p-3 rounded-xl mb-4 text-sm">
                        <p>âš ï¸ å¾®ä¿¡ç”¨æˆ·è¯·ç‚¹å³ä¸Šè§’ã€ŒÂ·Â·Â·ã€â†’ã€Œåœ¨æµè§ˆå™¨æ‰“å¼€ã€</p>
                    </div>
                    
                    <div id="qrcode" class="inline-block p-4 bg-white rounded-2xl shadow-inner max-w-full overflow-hidden"></div>
                    
                    <div class="mt-4 space-y-2">
                        <p class="text-sm text-gray-500">æ‰«æäºŒç»´ç å³å¯å‚ä¸æŠ½å¥–</p>
                        <div class="bg-gray-50 p-2 rounded-lg border border-gray-200">
                            <p class="text-xs text-gray-400 mb-1">é“¾æ¥åœ°å€ï¼š</p>
                            <p id="currentUrl" class="url-display text-gray-600 select-all"></p>
                        </div>
                        <button onclick="copyUrl()" class="text-sm text-blue-600 underline">å¤åˆ¶é“¾æ¥åˆ†äº«ç»™åŒäº‹</button>
                    </div>
                </div>

                <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                <div class="glass-panel rounded-3xl p-4 md:p-6 shadow-2xl">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-gradient-to-br from-red-500 to-red-600 rounded-2xl p-3 md:p-4 text-white text-center">
                            <div class="text-2xl md:text-3xl font-bold" id="remainingCount">18</div>
                            <div class="text-xs md:text-sm opacity-90">å‰©ä½™å¥–æ± </div>
                        </div>
                        <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-3 md:p-4 text-white text-center">
                            <div class="text-2xl md:text-3xl font-bold" id="drawnCount">0</div>
                            <div class="text-xs md:text-sm opacity-90">å·²æŠ½å–</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šæŠ½å¥–åŒºåŸŸå’Œå¥–æ±  -->
            <div class="space-y-6">
                <!-- æŠ½å¥–æŒ‰é’®å’Œç»“æœæ˜¾ç¤º -->
                <div class="glass-panel rounded-3xl p-6 md:p-8 shadow-2xl text-center relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-yellow-400 via-red-500 to-yellow-400"></div>
                    
                    <div class="mb-6 md:mb-8">
                        <div id="resultDisplay" class="w-24 h-24 md:w-32 md:h-32 mx-auto rounded-full bg-gradient-to-br from-gray-100 to-gray-300 flex items-center justify-center text-4xl md:text-6xl font-black text-gray-400 shadow-inner mb-4 transition-all duration-300">
                            ?
                        </div>
                        <h3 class="text-lg md:text-xl font-bold text-gray-700 px-2" id="resultText">è¾“å…¥å§“ååç‚¹å‡»æŠ½å¥–</h3>
                    </div>

                    <button id="drawBtn" onclick="startDraw()" class="btn-shine w-full py-3 md:py-4 bg-gradient-to-r from-red-500 via-yellow-500 to-red-500 text-white text-xl md:text-2xl font-bold rounded-2xl shadow-lg transform transition hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">
                        ğŸ² ç«‹å³æŠ½å¥–
                    </button>

                    <button id="resetBtn" onclick="resetPool()" class="mt-4 w-full py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-xl transition hidden">
                        ğŸ”„ é‡ç½®å¥–æ± 
                    </button>
                </div>

                <!-- å¥–æ± å±•ç¤º -->
                <div class="glass-panel rounded-3xl p-4 md:p-6 shadow-2xl">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span>ğŸ†</span> å¥–æ± çŠ¶æ€
                        <span class="text-xs md:text-sm font-normal text-gray-500 ml-auto" id="poolStatus">å‰©ä½™ 18 ä¸ªå·ç </span>
                    </h3>
                    <div id="numberPool" class="grid grid-cols-6 gap-2 md:gap-3">
                        <!-- æ•°å­—çƒå°†ç”±JSç”Ÿæˆ -->
                    </div>
                </div>

                <!-- å†å²è®°å½• -->
                <div class="glass-panel rounded-3xl p-4 md:p-6 shadow-2xl">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span>ğŸ“œ</span> ä¸­å¥–è®°å½•
                    </h3>
                    <div id="historyList" class="flex flex-wrap gap-2 max-h-40 md:max-h-48 overflow-y-auto">
                        <span class="text-gray-400 text-sm italic">æš‚æ— è®°å½•...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ£€æµ‹æ˜¯å¦æ˜¯å¾®ä¿¡æµè§ˆå™¨
        function isWechat() {
            return /MicroMessenger/i.test(navigator.userAgent);
        }
        
        // æ˜¾ç¤ºå¾®ä¿¡æç¤º
        function showWechatTip() {
            if (isWechat()) {
                document.getElementById('wechatTip').style.display = 'block';
            }
        }
        
        function closeWechatTip() {
            document.getElementById('wechatMask').classList.add('hidden');
        }
        
        // å¤åˆ¶é“¾æ¥
        function copyUrl() {
            const url = window.location.href.split('?')[0];
            document.getElementById('wechatUrl').textContent = url;
            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    alert('é“¾æ¥å·²å¤åˆ¶ï¼è¯·ç²˜è´´åˆ°æµè§ˆå™¨æ‰“å¼€');
                });
            } else {
                // å…¼å®¹æ—§æµè§ˆå™¨
                const input = document.createElement('input');
                input.value = url;
                document.body.appendChild(input);
                input.select();
                document.execCommand('copy');
                document.body.removeChild(input);
                alert('é“¾æ¥å·²å¤åˆ¶ï¼è¯·ç²˜è´´åˆ°æµè§ˆå™¨æ‰“å¼€');
            }
        }

        // åˆå§‹åŒ–æ•°æ®
        let availableNumbers = Array.from({length: 18}, (_, i) => i + 1);
        let drawnNumbers = [];
        let isRolling = false;
        let history = [];
        let currentUserName = '';

        // è®¾ç½®å§“å
        function setUserName() {
            const input = document.getElementById('userName');
            const name = input.value.trim();
            
            if (!name) {
                alert('è¯·è¾“å…¥å§“åï¼');
                return;
            }
            
            currentUserName = name;
            document.getElementById('displayUserName').textContent = name;
            document.getElementById('currentUser').classList.remove('hidden');
            input.disabled = true;
            document.getElementById('nameBtn').textContent = 'æ›´æ¢å§“å';
            document.getElementById('nameBtn').onclick = resetUserName;
            document.getElementById('resultText').textContent = 'ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æŠ½å¥–';
            
            localStorage.setItem('lotteryUserName', name);
        }

        // é‡ç½®å§“å
        function resetUserName() {
            const input = document.getElementById('userName');
            input.disabled = false;
            input.value = '';
            input.focus();
            document.getElementById('currentUser').classList.add('hidden');
            document.getElementById('nameBtn').textContent = 'ç¡®è®¤å‚ä¸';
            document.getElementById('nameBtn').onclick = setUserName;
            currentUserName = '';
            document.getElementById('resultText').textContent = 'è¾“å…¥å§“ååç‚¹å‡»æŠ½å¥–';
            localStorage.removeItem('lotteryUserName');
        }

        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„å§“å
        function checkStoredName() {
            const stored = localStorage.getItem('lotteryUserName');
            if (stored) {
                document.getElementById('userName').value = stored;
                setUserName();
            }
        }

        // åˆå§‹åŒ–é¡µé¢
        function init() {
            showWechatTip();
            generateQRCode();
            renderPool();
            updateStats();
            checkStoredName();
            
            const urlParams = new URLSearchParams(window.location.search);
            const savedState = urlParams.get('state');
            if (savedState) {
                try {
                    const state = JSON.parse(atob(savedState));
                    availableNumbers = state.available || availableNumbers;
                    drawnNumbers = state.drawn || [];
                    history = state.history || [];
                    updateStats();
                    renderPool();
                    renderHistory();
                } catch(e) {
                    console.log('æ— ä¿å­˜çŠ¶æ€');
                }
            }
        }

        
        // ç”ŸæˆäºŒç»´ç 
function generateQRCode() {
    const url = "https://yingzheng666.github.io/2026-NIAN/";
    document.getElementById('currentUrl').textContent = url;
    document.getElementById('wechatUrl').textContent = url;
    
    try {
        const qrcode = new QRCode(document.getElementById("qrcode"), {
            text: url,
            width: 180,
            height: 180,
            colorDark : "#000000",
            colorLight : "#ffffff",
            correctLevel : QRCode.CorrectLevel.H
        });
    } catch(e) {
        console.error('äºŒç»´ç ç”Ÿæˆå¤±è´¥', e);
    }
}

        // æ¸²æŸ“å¥–æ± 
        function renderPool() {
            const container = document.getElementById('numberPool');
            container.innerHTML = '';
            
            for (let i = 1; i <= 18; i++) {
                const ball = document.createElement('div');
                const isDrawn = !availableNumbers.includes(i);
                const isLastWinner = history.length > 0 && history[history.length - 1].includes(`â†’ ${i}`);
                
                ball.className = `number-ball aspect-square rounded-full flex items-center justify-center text-sm md:text-lg font-bold cursor-pointer select-none ${
                    isDrawn 
                        ? 'drawn' 
                        : isLastWinner 
                            ? 'winner' 
                            : 'bg-gradient-to-br from-white to-gray-100 text-gray-700 border-2 border-gray-200'
                }`;
                ball.textContent = i;
                ball.title = isDrawn ? 'å·²æŠ½å–' : 'å¯æŠ½å–';
                container.appendChild(ball);
            }
        }

        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            document.getElementById('remainingCount').textContent = availableNumbers.length;
            document.getElementById('drawnCount').textContent = drawnNumbers.length;
            document.getElementById('poolStatus').textContent = `å‰©ä½™ ${availableNumbers.length} ä¸ªå·ç `;
            
            const resetBtn = document.getElementById('resetBtn');
            if (availableNumbers.length === 0) {
                resetBtn.classList.remove('hidden');
                document.getElementById('drawBtn').disabled = true;
                document.getElementById('drawBtn').textContent = 'å¥–æ± å·²ç©º';
            } else {
                resetBtn.classList.add('hidden');
                document.getElementById('drawBtn').disabled = false;
                document.getElementById('drawBtn').textContent = 'ğŸ² ç«‹å³æŠ½å¥–';
            }
        }

        // æ¸²æŸ“å†å²è®°å½•
        function renderHistory() {
            const container = document.getElementById('historyList');
            if (history.length === 0) {
                container.innerHTML = '<span class="text-gray-400 text-sm italic">æš‚æ— è®°å½•...</span>';
                return;
            }
            
            container.innerHTML = history.map((record, index) => {
                const isLast = index === history.length - 1;
                const parts = record.split(' â†’ ');
                const hasName = parts.length === 2;
                const name = hasName ? parts[0] : null;
                const num = hasName ? parts[1] : record;
                
                return `
                    <div class="inline-flex items-center gap-1 md:gap-2 px-2 md:px-3 py-1.5 md:py-2 rounded-xl text-xs md:text-sm font-bold ${
                        isLast 
                            ? 'bg-gradient-to-r from-yellow-100 to-orange-100 text-orange-800 border-2 border-yellow-400 shadow-lg' 
                            : 'bg-gray-100 text-gray-600'
                    }">
                        <span class="text-xs opacity-60">#${index + 1}</span>
                        ${name ? `<span class="text-red-600 max-w-[60px] md:max-w-[80px] truncate">${name}</span><span class="text-gray-400">â†’</span>` : ''}
                        <span class="text-base md:text-lg text-red-700">${num}</span>
                    </div>
                `;
            }).join('');
            
            container.scrollTop = container.scrollHeight;
        }

        // å¼€å§‹æŠ½å¥–
        function startDraw() {
            if (!currentUserName) {
                alert('è¯·å…ˆè¾“å…¥å§“åï¼');
                document.getElementById('userName').focus();
                return;
            }
            
            if (isRolling || availableNumbers.length === 0) return;
            
            isRolling = true;
            const btn = document.getElementById('drawBtn');
            const display = document.getElementById('resultDisplay');
            const text = document.getElementById('resultText');
            
            btn.disabled = true;
            text.textContent = 'æŠ½å¥–ä¸­...';
            display.classList.add('rolling-animation');
            
            let rollCount = 0;
            const maxRolls = 20;
            const rollInterval = setInterval(() => {
                const randomNum = availableNumbers[Math.floor(Math.random() * availableNumbers.length)];
                display.textContent = randomNum;
                rollCount++;
                
                if (rollCount >= maxRolls) {
                    clearInterval(rollInterval);
                    finalizeDraw();
                }
            }, 100);
        }

        // ç¡®å®šç»“æœ
        function finalizeDraw() {
            const display = document.getElementById('resultDisplay');
            const text = document.getElementById('resultText');
            const btn = document.getElementById('drawBtn');
            
            const randomIndex = Math.floor(Math.random() * availableNumbers.length);
            const winner = availableNumbers[randomIndex];
            
            availableNumbers.splice(randomIndex, 1);
            drawnNumbers.push(winner);
            
            const record = currentUserName ? `${currentUserName} â†’ ${winner}` : winner;
            history.push(record);
            
            display.textContent = winner;
            display.classList.remove('rolling-animation');
            display.classList.add('winner');
            text.innerHTML = `ğŸ‰ æ­å–œ <span class="text-red-600 font-bold">${currentUserName}</span> æŠ½ä¸­ <span class="text-2xl md:text-3xl font-bold text-yellow-600">${winner}</span>ï¼`;
            
            createConfetti();
            renderPool();
            updateStats();
            renderHistory();
            saveState();
            
            isRolling = false;
            if (availableNumbers.length > 0) {
                btn.disabled = false;
            }
            
            setTimeout(() => {
                display.classList.remove('winner');
            }, 3000);
        }

        // åˆ›å»ºå½©çº¸æ•ˆæœ
        function createConfetti() {
            const colors = ['#fbbf24', '#ef4444', '#f59e0b', '#10b981', '#3b82f6', '#ec4899'];
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 4000);
                }, i * 50);
            }
        }

        // é‡ç½®å¥–æ± 
        function resetPool() {
            if (!confirm('ç¡®å®šè¦é‡ç½®å¥–æ± å—ï¼Ÿæ‰€æœ‰è®°å½•å°†è¢«æ¸…ç©ºã€‚')) return;
            
            availableNumbers = Array.from({length: 18}, (_, i) => i + 1);
            drawnNumbers = [];
            history = [];
            
            document.getElementById('resultDisplay').textContent = '?';
            document.getElementById('resultDisplay').className = 'w-24 h-24 md:w-32 md:h-32 mx-auto rounded-full bg-gradient-to-br from-gray-100 to-gray-300 flex items-center justify-center text-4xl md:text-6xl font-black text-gray-400 shadow-inner mb-4 transition-all duration-300';
            document.getElementById('resultText').textContent = currentUserName ? 'ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æŠ½å¥–' : 'è¾“å…¥å§“ååç‚¹å‡»æŠ½å¥–';
            
            renderPool();
            updateStats();
            renderHistory();
            saveState();
        }

        // ä¿å­˜çŠ¶æ€åˆ°URL
        function saveState() {
            const state = {
                available: availableNumbers,
                drawn: drawnNumbers,
                history: history
            };
            const encoded = btoa(JSON.stringify(state));
            const newUrl = window.location.protocol + '//' + window.location.host + window.location.pathname + '?state=' + encoded;
            window.history.replaceState({}, '', newUrl);
        }

        // å¯åŠ¨
        init();
    </script>
</body>
</html>
